(function(c,d){if(c.define){return}function e(i){return Object.prototype.toString.call(i)==="[object Function]"}var g={};var k=null;var b=document.getElementsByTagName("script");for(var m=0,j=b.length;m<j&&!k;m++){k=b[m].getAttribute("data-main")}if(!k){throw new Error("No data-main attribute in script tag.")}function h(l){if(!g[l]){throw new Error("Module "+l+" is not defined.")}var i=g[l];if(i.inited===false){f(l)}return i.ret}function f(o){var n={};var l=g[o];if(e(g[o].factory)){var i=g[o].factory.apply(d,[h,n,d]);l.ret=i===d?n:i}else{l.ret=g[o].factory}l.inited=true}function a(i,n,l){if(g[i]){throw new Error("Module "+i+" has been defined already.")}if(e(n)){l=n}g[i]={factory:l,inited:false};if(i===k){f(i)}}c.define=a})(window);define("common/es5",function(c,b,a){(function(d){d.bind||(d.bind=function(e){var f=this;return function(){return f.apply(e,arguments)}})})(Function.prototype);(function(d){var e=d.setInterval;var f=d.setTimeout;d.setInterval=function(){var g=arguments;var i=g[0];var j=g[1];var h=Array.prototype.slice.call(g,2);return e(function(){i.apply(window,h)},j)};d.setTimeout=function(){var g=arguments;var i=g[0];var j=g[1];var h=Array.prototype.slice.call(g,2);return f(function(){i.apply(window,h)},j)}})(window)});define("common/lib_plus",function(e,b,a){var f=e("common/config");var d=e("common/user_account");(function(){var k=$(".def-feild");var i;var j;k.live("focus",function(){var l=$(this);i=$.trim(l.val());j=l.attr("def-data");if(i===j){l.val("");l.removeClass("color-gray")}});k.live("blur",function(){var l=$(this);i=$.trim(l.val());j=l.attr("def-data");if(i===""||i===j){l.val(j);l.addClass("color-gray")}})})();$(".js-log").live("click",function(){var k=$(this);var j=k.data("log");var i;var l;if(!j){return}i=k.closest(".mod");l=f.log+j;if(i.length!==0&&i.id!==""){l+="&mod="+i.attr("id")}$("<img>").attr("src",l)});$("a").live("click",function(){var i=$(this).attr("href");if(!i||!window._gaq){return}if(i.indexOf(location.host)===7||i.indexOf(location.host)===8||i.indexOf("http")!=0){_gaq.push(["_trackEvent","Self","Click",i])}else{_gaq.push(["_trackEvent","Others","Click",i])}});$(".login").live("click",function(i){d.isLogin(function(){window.location.reload()});i.preventDefault()});$(".discount-f-share").live({mouseover:function(){$(this).addClass("active")},mouseout:function(){$(this).removeClass("active")}});$(".discount-f-share .discount-share-ctn a").live("click",function(){var i=$(this).data("url");$.ajax({url:i,type:"GET",dataType:"json",timeout:30000,cache:false,success:function(j){},error:function(j){}})});$(".discount-f-fav a").live("click",function(k){var i=$(this).data("id");var j=$(this).parent().parent().find(".discount-f-fav");d.isActive(function(){$.fancybox.close();j.eq(0).fadeOut("fast",function(){j.eq(1).fadeIn("fast")});$.ajax({url:f.favor(i),type:"GET",dataType:"json",timeout:30000,cache:false,success:function(l){},error:function(l){}})});k.preventDefault()});var h=e("common/key.scorll");h.init();var g=(function(){var i;return{showError:function(j){if(!i){i=$("#tmpl-promptDialog")}if(!j||typeof j!=="string"){j=f.errorMsg}$.fancybox.show(i.tmpl({message:j}))},confirm:function(j){var k=e("common/transceiver").create();k.trigger("oauth:cancel:dailog",j)},userAccount:d,faq:function(){var j=["http://chat10.live800.com/live800/chatClient/chatbox.jsp?companyID=210734&configID=181519&jid=2116824014&skillId=10527","&enterurl=",window.location.href].join("");window.open(j,"","width=600px, height=500px, top=0, left=0, toolbar=no, menubar=0, scrollbars=no, resizable=no, location=no, status=no")}}})();var c=e("common/app.ctrl");c.extend(g);e("common/app_loading");e("common/selection");e("common/phone.auth");e("common/fancybox.plus")});define("modules/global/top/notice_remind",function(e,c,b){var f={events:{},on:function(g,i,h){this.events[g]=this.events[g]||[];this.events[g].push({callback:i,context:h})},trigger:function(g,h){$.each(this.events[g],function(i,j){j.callback.call(j.context,h)})}};var d=$.extend({},f,{data:{},updateData:function(g){this.data=g;this.trigger("render",this.data)}});var a=(function(){var i=$("#top");var l=i.find(".msg");var h=i.find("b.count");var j=i.find(".msg-no-info");var g=i.find(".msg-info");var m=i.find(".show-msg");var k=g.find(".show-msg-ctn");var n={};return{init:function(){d.on("render",this.render,this)},render:function(){var o=d.data;var p=false;if(o.count===0){l.addClass("no-msg");g.hide();j.show();l.removeClass("current");m.hide();n=o.data;return}if(o.count>99){o.count="99+"}l.removeClass("no-msg");h.html(o.count);g.show();j.hide();k.hide();$.each(o.data,function(s,r){var q=k.filter("[data-name="+s+"]");q.find("b").html(r);q.show()});$.each(o.data,function(r,q){if(!n[r]||n[r]<q){p=true}});if(p){l.addClass("current");m.show()}n=o.data}}})();a.init();(function(){var j=e("common/cookie");var n=e("common/config");var p=e("common/transceiver").create();var q="notice";var i=n.noticeTime*1000;var m=3*1000;var l=null;if(!j.get("NTES_LOGINED")){return}function h(){try{$.ajax({cache:false,dataType:"json",timeout:30000,type:"GET",url:n.notice,success:function(t){var u={count:0,data:{}};if(t.status!=="succ"){g();return}$.each(t.data,function(x,w){var v=parseInt(w);if(v){u.count+=v;u.data[x]=v}});noticeMsg={data:u,isLock:false,lastUpdate:+new Date()};try{j.update(q,JSON.stringify(noticeMsg));d.updateData(noticeMsg.data)}catch(s){}},error:function(s){g()}})}catch(r){}}function g(){try{j.del(q)}catch(r){}window.clearInterval(l)}function k(){var s=JSON.stringify({isLock:true});try{j.update(q,s)}catch(r){j.add(q,s)}h()}function o(){var s=j.get(q);if(!j.get("NTES_LOGINED")){g();return}if(!s){k();return}try{s=unescape(s);s=JSON.parse(s);if(typeof s!=="object"||typeof s.isLock==="undefined"){k();return}}catch(r){k();return}if(s.isLock){return}if(+new Date()-s.lastUpdate>i){s.isLock=true;j.update(q,JSON.stringify(s));h();return}d.updateData(s.data)}l=window.setInterval(o,m);p.listen("top:notice",function(){var r=[].slice.call(arguments)[0];if(r.refresh){h()}})})()});define("modules/global/top/order_remind",function(h,b,a){var d=h("common/cookie");var k=h("common/config");var g="gw_fo";var j=k.noticeTime*1000;var e=null;var l=$("#fxOrderTips");function f(){var m=d.get(g);if(m&&m==="true"){l.fadeIn("fast")}}l.delegate(".close","click",function(m){d.update(g,"false");l.fadeOut("fast")});f();e=window.setInterval(f,j);if(!window.XMLHttpRequest){var i=function(){var n=$(document).scrollTop();var m=$(window).height();l.css("top",n+m-185+"px")};var c=null;var j=50;$(window).bind("scroll",function(){window.clearTimeout(c);c=window.setTimeout(i,j)});i()}});define("modules/global/top/top",function(g,d,c){var b=$("#top");var f=b.find(".welinfo");var a=b.find(".show-msg");var e=b.find(".sctop-help");var h=g("common/config");var i=g("common/transceiver").create();e.hover(function(){e.addClass("current")},function(){e.removeClass("current")});b.delegate(".welinfo-name","click",function(j){j.preventDefault();j.stopPropagation();f.toggleClass("active")});$(document).click(function(){if(f.hasClass("active")){f.removeClass("active")}});b.delegate(".msg","click",function(j){j.preventDefault();a.toggle();$(this).toggleClass("current")});b.delegate("span.ignore a","click",function(j){j.preventDefault();$.ajax({cache:false,dataType:"json",timeout:30000,type:"GET",url:h.readAll,success:function(k){a.hide();b.find(".msg").removeClass("current");i.trigger("top:notice",{refresh:true})},error:function(k){}})})});define("modules/global/search_box/suggest",function(e,c,b){$.widget("custom.gouwuComplete",$.ui.autocomplete,{_suggest:function(g){$.ui.autocomplete.prototype._suggest.call(this,g);var f=this.menu.element;var h=parseInt(f.css("top"))+10;f.css({top:h+"px","z-index":99})},_create:function(){$.ui.autocomplete.prototype._create.call(this);var f=this;this.element.unbind("keydown.autocomplete");this.element.bind("keydown.autocomplete",function(h){if(f.options.disabled||f.element.propAttr("readOnly")){return}var i=false;var g=$.ui.keyCode;switch(h.keyCode){case g.PAGE_UP:f._move("previousPage",h);break;case g.PAGE_DOWN:f._move("nextPage",h);break;case g.UP:f._move("previous",h);h.preventDefault();break;case g.DOWN:f._move("next",h);h.preventDefault();break;case g.ENTER:case g.NUMPAD_ENTER:if(f.menu.active){i=true}case g.TAB:if(!f.menu.active){return}f.menu.select(h);break;case g.ESCAPE:f.element.val(f.term);f.close(h);break;default:clearTimeout(f.searching);f.searching=setTimeout(function(){if(f.term!=f.element.val()){f.selectedItem=null;f.search(null,h)}},f.options.delay);break}});this.menu.element.click(function(g){if(!$(g.target).closest(".ui-menu-item a").length){return}if(f.selectedItem){d.selected.call(window,f.selectedItem)}})}});var d=(function(){var j=e("common/config");var l=j.getGoodsSugget;var m=null;var f=null;var i={};var h={callback:null,get:function(n){var o;if(m){m.remove();m=null}if(!!!f){f=$("body")}o=l+"&query="+encodeURIComponent(n);m=$('<script type="text/javascript" charset="utf-8" src='+o+">");f.append(m)},updateCall:function(n){if($.isFunction(this.callback)){this.callback(n)}}};var g=function(n){window.location=n.url};var k=function(n){n.gouwuComplete({source:function(q,o){var p=q.term;if(i[p]){o($.map(i[p].r,function(r){return r}));return}h.callback=function(r){i[p]=r;o($.map(r.r,function(s){return s}))};h.get(q.term)},select:function(p,o){}})};window._hui_goods=h;return{bind:k,selected:g}})();var a={init:function(){var f=$("div.mod-search-box input.search-value").eq(0);d.bind(f)}};a.init()});define("modules/global/search_box/tips",function(d,c,b){var a={init:function(){this.selector={sValue:"div.mod-search-box input.search-value",sButton:"div.mod-search-box input.search-btn"};this.$sValue=null;this.focus();this.addEvent()},focus:function(){var e=$(this.selector.sValue).eq(0);var g=$(document).scrollTop();var f=$("body").attr("class");if($.trim(e.val())===""){e.prev().show();if(f==="p-huihui-index"&&e.offset().top>g){e[0].focus()}}},addEvent:function(){var e=this.selector.sValue;this.onChange=this.onChange.bind(this);if($.browser.msie){$(document).delegate(e,"keydown",this.onChange);$(document).delegate(e,"keyup",this.onChange);$(document).delegate(e,"keypress",this.onChange)}else{$(document).delegate(e,"input",this.onChange)}$(document).delegate(e,"focus",this.onFocus);$(document).delegate(e,"blur",this.onBlur);this.onKeyDown=this.onKeyDown.bind(this);$(document).delegate(e,"keydown",this.onKeyDown);if(!window.XMLHttpRequest){$(document).delegate(this.selector.sButton,{mouseover:this.onBtnMouseOver,mouseout:this.onBtnMouseOut})}},onChange:function(f){var g=$(f.target);if($.trim(g.val())!==""){g.prev().hide()}},onKeyDown:function(f){if(!this.$sValue){this.$sValue=$(this.selector.sValue).eq(0)}if($.trim(this.$sValue.val())===""&&(f.keyCode===40||f.keyCode===38)){this.$sValue[0].blur()}},onFocus:function(f){$(f.target).prev().hide()},onBlur:function(f){var g=$(f.target);if($.trim(g.val())===""){g.prev().show()}},onBtnMouseOver:function(f){$(f.target).addClass("search-btn-hover")},onBtnMouseOut:function(f){$(f.target).removeClass("search-btn-hover")}};a.init()});define("modules/global/nav/nav",function(d,b,a){var h=$("#nav .shops");var e=$("#nav .toolbar-rss");var g=$("#nav .nav-toolbar-rss");var f=$("#nav .toolbar-rss-show");var c;h.hover(function(){h.addClass("active")},function(){h.removeClass("active")});e.hover(function(){g.addClass("active")},function(){timer=setTimeout(function(){g.removeClass("active")},500)});f.hover(function(){clearTimeout(timer)},function(){g.removeClass("active")})});define("modules/global/nav/shops_tip",function(f,d,c){var a={mod:"#nav",shopNav:"li[data-action=shopnav]",shopTips:"li[data-action=shoptips]"};var e=null;var i="navmall-active";var b=$(a.mod);var j=null;var h=function(){window.clearTimeout(e);if(!j){j=b.find(a.shopNav)}j.addClass(i)};var g=function(){window.clearTimeout(e);e=window.setTimeout(function(){j.removeClass(i)},200)};b.delegate(a.shopNav,"mouseover",h);b.delegate(a.shopTips,"mouseover",h);b.delegate(a.shopNav,"mouseout",g);b.delegate(a.shopTips,"mouseout",g)});define("modules/global/nav/favorite",function(d,c,b){var a={init:function(){this.url=window.location.href;this.title=window.document.title;this.addFav=this.addFav.bind(this);$(document).delegate("#nav a.toolbar-collect","click",this.addFav)},addFav:function(){if(document.all&&window.external){window.external.AddFavorite(this.url,this.title)}else{if(window.sidebar){window.sidebar.addPanel(this.title,this.url,"")}else{alert("浏览器不支持，请按Ctrl+D手动加入收藏夹!")}}}};a.init()});define("modules/discount/shop_archives/shop_archives",function(c,b,a){var d=c("common/transceiver").create();$("#shopArchives .shop-archives-comment-ctn").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$("#shopArchives .ml-10").live("click",function(){var e=$(this);var f="";if(e.hasClass("shop-detail")){f="shopArchives:shop:more"}if(e.hasClass("comment")){f="shopArchives:comment:more"}if(e.hasClass("fx")){f="shopArchives:fx:more"}if(f!==""){d.trigger(f)}});$("#shopArchives a.go-to-shop").click(function(){var e=c("common/transceiver").create();e.trigger("cshop:skip:dailog:show")})});define("modules/discount/shop_archives/tips",function(c,b,a){var d={init:function(){this.selector={module:"span.shop-support-kf",button:"a.shop-support-kf-alink",tips:"div.kf-tips"};this.handle={};this.addEvent()},addEvent:function(){this.showTips=this.showTips.bind(this);this.hideTips=this.hideTips.bind(this);var e=[[this.selector.module,this.selector.button].join(" "),[this.selector.module,this.selector.tips].join(" ")].join(", ");$(document).delegate(e,{mouseover:this.showTips,mouseout:this.hideTips})},showTips:function(f){var g=$(f.target).closest(this.selector.module);var h=g.data("key");if(!h){h=+new Date();g.data("key",h)}window.clearTimeout(this.handle[h]);g.addClass("kf-tips-active")},hideTips:function(f){var g=$(f.target).closest(this.selector.module);var h=g.data("key");this.handle[h]=window.setTimeout(function(){g.removeClass("kf-tips-active")},50)}};d.init()});define("modules/discount/shop_introduce/comment_score",function(h,e,d){var i=$("#shopIntroduce .shop-star-comment");var b=i.data("comtext").split(",");var c=$("#shopIntroduce .shop-star-comment a");var a=$("#shopIntroduce .shop-star-comment-num");var g;var f={goods:null,logistics:null,service:null,isComplete:false,eCode:"s012",clear:function(){f.goods=null;f.logistics=null;f.service=null;f.isComplete=false;f.eCode="s012";c.removeClass("current");a.html("")}};c.live("mouseover",function(k){var l=$(this);var j=l.index();var m=l.parent().next(".shop-star-comment-num");m.html(b[j]);g=l.parent().find(".current");g.removeClass("current")});c.live("mouseout",function(k){var l=$(this);var m=l.parent().next(".shop-star-comment-num");var j="";if(g.length>0){g.addClass("current");j=b[g.index()]}m.html(j)});c.live("click",function(l){l.preventDefault();var n=$(this);var o=n.parent().next(".shop-star-comment-num");var k=n.index();n.addClass("current");o.html(b[k]);g=n;var m=n.parent();if(m.hasClass("goods")){f.goods=k+1}if(m.hasClass("logistics")){f.logistics=k+1}if(m.hasClass("service")){f.service=k+1}var j="s";if(!f.goods){j+="0"}if(!f.logistics){j+="1"}if(!f.service){j+="2"}f.eCode=j;if(f.goods&&f.logistics){f.isComplete=true}});return f});define("modules/discount/shop_introduce/pager",function(f,c,b){var a=$("#shopIntroduce .user-comment-ctn");var d=$("#shopIntroduce .paging").data("shop");var g=f("common/config");var e=false;var h=$(".paging-loading i").hide();$("#shopIntroduce .paging a").live("click",function(i){i.preventDefault();if(e){return}var j=$(this).data("pageNo");e=true;h.show();$.ajax({url:g.getShopComment(d,j),type:"GET",dataType:"text",timeout:30000,cache:false,success:function(k){a.empty().html(k);e=false;$(".paging-loading i").hide()},error:function(k){e=false;$(".paging-loading i").hide()}})})});define("modules/discount/shop_introduce/shop_introduce",function(p,c,d){var i=p("common/user_account");var j=p("modules/discount/shop_introduce/comment_score");var k=p("common/config");var o=$("#shopIntroduce .user-comment-publish").data("shop");var e=$("#shopIntroduce textarea");var f=$("#shopIntroduce .shop-star-comment a");var n=$("#shopIntroduce .prompt-state");var l=$("#shopIntroduce .loading");var g=e.attr("def-data");var m=$("#tmpl-promptDialog");var a;var h=false;var b={succ:function(){$("#shopIntroduce .tips-dailog").fadeIn(800).fadeOut(200);e.val(g).addClass("color-gray");j.clear()},validate:function(q){n.filter(":visible").hide();n.filter("[data-ikey=invalid-"+q+"]").show()},error:function(q){$.fancybox.show(m.tmpl({message:q}))},hideAll:function(){n.filter(":visible").hide()}};$("#shopIntroduce form").live("submit",function(q){q.preventDefault();i.isLogin(function(){if(h){return}if(!j.isComplete){b.validate(j.eCode);return}a=$.trim(e.val());if(a===""||a===g){b.validate("text");return}if(a.length<10||a.length>100){b.validate("len");return}b.hideAll();i.isActive(function(){$.fancybox.close();var r="merchantComment="+a+"&deliverScore="+j.logistics+"&serviceScore="+j.service+"&productScore="+j.goods;h=true;l.show();$.ajax({cache:false,data:r,dataType:"json",timeout:30000,type:"POST",url:k.postShopComment(o),success:function(s){h=false;l.hide();if(s.status==="succ"){b.succ()}else{b.error(s.message)}},error:function(){h=false;l.hide();b.error(k.errorMsg)}})})})})});define("modules/discount/shop_introduce/tab_menu",function(f,b,a){var g=$("#shopIntroduce .tab-nav a");var e=f("common/tab_menu");var d=new e({wrap:"#shopIntroduce .tab-wrap",navs:".tab-nav a",contents:".tab-content-wrap .tab-content",navCurStyle:"current",contentCurStyle:"current",eventName:"click",callback:function(){}});var i=window.location.toString();var c=i.split("#");if(c.length>=2){if(c[1]==="tab1"){d.swapTab("shop")}if(c[1]==="tab2"){d.swapTab("comment")}}var h=f("common/transceiver").create();h.listen("shop:comment:more",function(){d.swapTab("comment")});h.listen("shopArchives:comment:more",function(){d.swapTab("comment")});h.listen("shopArchives:fx:more",function(){d.swapTab("fx")});h.listen("shopArchives:shop:more",function(){d.swapTab("shop")})});define("modules/coupons/hot_coupons/hot_coupons",function(d,b,a){var c=$("#hotCoupons .side-hot li");c.first().addClass("current");c.live("mouseover",function(){c.removeClass("current");$(this).addClass("current")})});define("modules/discount/shop_comment/shop_comment",function(c,b,a){var d=c("common/transceiver").create();$("#shopComment .more").live("click",function(){d.trigger("shop:comment:more")})});define("modules/global/new_feedback/new_feedback",function(d,c,b){var a={init:function(){this.$mod=$("#newFeedback");this.$topButton=this.$mod.find("a.forward");this.addEvent()},addEvent:function(){this.$mod.delegate("a.forward","click",this.toTop);var e=null;var f=50;this.onScroll=this.onScroll.bind(this);$(window).bind("scroll",(function(){window.clearTimeout(e);e=window.setTimeout(this.onScroll,f)}).bind(this));this.onScroll();var g=null;if(!window.XMLHttpRequest){$(window).bind("resize",(function(){window.clearTimeout(g);e=window.setTimeout(this.onScroll,f)}).bind(this))}},toTop:function(f){$("html, body").animate({scrollTop:0},200);f.preventDefault()},onScroll:function(){var f=$(document).scrollTop();if(f>0){this.$topButton.fadeIn()}else{this.$topButton.fadeOut()}if(window.XMLHttpRequest){return}var e=$(window).height();this.$mod.css("top",f+e-0+"px")}};a.init()});define("modules/huihui/login_guide/login_guide",function(d,c,b){var a={init:function(){this.$mod=$("#loginGuide");this.addEvent()},addEvent:function(){var f=this;var h=null;var e=null;var g=50;if(!window.XMLHttpRequest){this.onScroll=this.onScroll.bind(this);$(window).bind("scroll",(function(){window.clearTimeout(e);e=window.setTimeout(this.onScroll,g)}).bind(this));$(window).bind("resize",(function(){window.clearTimeout(h);e=window.setTimeout(this.onScroll,g)}).bind(this));this.onScroll()}this.$mod.delegate(".input-psw input","focus",function(){$(this).parent().find("span").hide()});this.$mod.delegate(".input-psw input","blur",function(){if($(this).val()===""){$(this).parent().find("span").show()}});this.$mod.delegate(".close-times","click",function(){f.$mod.remove()});this.$mod.delegate("#loginGuide form","submit",function(j){var l=$("#loginGuide input[name=username]");var i=$("#loginGuide input[name=password]");var k=$.trim(l.val());if(k===""||k===l.attr("def-data")){l.focus();j.preventDefault();return}if($.trim(i.val())===""){i.focus();j.preventDefault();return}})},onScroll:function(){var f=$(document).scrollTop();var e=$(window).height();this.$mod.css("top",f+e-90+"px")}};a.init()});define("modules/template/cshop_skip_dailog/cshop_skip_dailog",function(e,c,b){var d={tmpl:"#tmpl-cshopSkipDailog"};var a;var f=e("common/transceiver").create();f.listen("cshop:skip:dailog:show",function(){a=a||$(d.tmpl);$.fancybox.show(a.tmpl())})});define("modules/template/verifyphone_dailog/verifyphone",function(f,c,b){var d={tmpl:"#tmpl-verifyphoneDialog"};var a;function e(i){a=a||$(d.tmpl);var h=a.tmpl(i);$.fancybox.show(h,function(){var j=f("modules/template/verifyphone_dailog/phone.code");var k=j;k.init(i.type,i.phone,h);var l=f("modules/template/verifyphone_dailog/phone.bind");l.init(h,i.callback)})}var g=f("common/transceiver").create();g.listen("mobile:validate:show",function(h){e(h)})});define("fragments/login/login",function(f,b,a){var d=f("common/validate_feild");var g=f("common/account_suggest");var c=f("common/cookie");var e={init:function(){this.selector={container:"div.login-container",userName:"input.input-s[name=username]",password:"input.input-s[name=password]",skipUrl:"input[name=url]",validateTip:"#loginTiparea",validateTipCloseButton:"#loginTiparea a",saveLogin:"#savelogin",saveLoginTip:"#rememberPsw",saveLoginTipCloseButton:"#rememberPsw a"};this.addEvent();var h=$(this.selector.container);if(h.length===0){return}var j=h.find(this.selector.userName);var i=h.find(this.selector.password);var k=new g({obj:j,password:i,appendTo:"div.login-container div.login-tip"});j.bind("keydown",function(m){if(m.keyCode===13){i.focus();m.preventDefault()}});var l=c.get("P_INFO");if(typeof l==="string"&&l.split("|")[0].indexOf("@")>0){j.val(l.split("|")[0]).removeClass("color-gray")}},addEvent:function(){var h=null;for(h in this){if(typeof this[h]==="function"){this[h]=this[h].bind(this)}}$(document).delegate(this.selector.saveLogin,{mouseover:this.showsaveLoginTip,mouseout:this.hidesaveLoginTip});$(document).delegate(this.selector.saveLoginTipCloseButton,"click",this.hidesaveLoginTip);$(document).delegate(this.selector.container+" form","submit",this.onSubmit);$(document).delegate(this.selector.validateTipCloseButton,"click",this.hideValidateTip);$(document).delegate(this.selector.container+" "+this.selector.userName,"focus",this.hideValidateTip);$(document).delegate(this.selector.container+" "+this.selector.password,"focus",this.hideValidateTip)},showsaveLoginTip:function(){$(this.selector.saveLoginTip).show()},hidesaveLoginTip:function(){$(this.selector.saveLoginTip).hide()},showValidateTip:function(){$(this.selector.validateTip).show()},hideValidateTip:function(){$(this.selector.validateTip).hide()},onSubmit:function(i){var h=$(this.selector.container);var l=h.find(this.selector.userName);var j=h.find(this.selector.password);var o=h.find(this.selector.skipUrl);var m=$.trim(l.val());var n=$.trim(j.val());var k=l.attr("def-data");if($.trim(o.val())===""){o.val(window.location.href)}if(m===""||m===k||!d.rules.email.test(m)||!d.rules.min6(n)){this.showValidateTip();i.preventDefault();return}}};e.init()});define("modules/template/oauth_cancel_dailog/oauth_cancel_dailog",function(f,c,b){var d={tmpl:"#tmpl-oauthCancelDailog",mod:"#oauthCancelDailog",sureButton:"a.sure",cancelButton:"a.cancel"};var e={title:"系统提示",content:"确定？",sureHandle:null,cancelHandle:function(){$.fancybox.close()}};var a;function h(j){var i=$(d.mod);i.delegate(d.sureButton,"click",function(){if($.isFunction(j.sureHandle)){j.sureHandle()}});i.delegate(d.cancelButton,"click",function(){if($.isFunction(j.cancelHandle)){j.cancelHandle()}})}var g=f("common/transceiver").create();g.listen("oauth:cancel:dailog",function(i){a=a||$(d.tmpl);var j=$.extend({},e,i);$.fancybox.show(a.tmpl(j),function(){h(j)})})});define("common/user_account",function(g,c,b){var d=g("common/cookie");var a=g("common/config");var h=g("common/account_suggest");var e={};var f={$activeTmpl:null,$loginTmpl:null,activeCallBack:null,init:function(){var i=null;for(i in this){if(typeof this[i]==="function"){this[i]=this[i].bind(this)}}},isLogin:function(i){if(d.get("NTES_LOGINED")){if(typeof i==="function"){i()}return}this.$loginTmpl=this.$loginTmpl||$("#tmpl-loginDailog");$.fancybox.show(this.$loginTmpl.tmpl(),this.bindLoginForm)},isActive:function(i){this.isLogin(i)},isNeteaseAccount:function(l,k,j){var i=$.trim(l);if(e[i]){if($.isFunction(k)){k()}return}$.ajax({cache:false,dataType:"json",timeout:30000,type:"GET",data:{username:i},url:a.validateAccount,success:function(m){if(m.status==="succ"){e[i]=true;if($.isFunction(k)){k()}return}if($.isFunction(j)){j()}}})},resetCookie:function(){var i={type:"CHECK_ACTIVATE",pwd:new Date().getTime()};$.ajax({cache:false,data:i,timeout:30000,url:a.userInfo,success:this.checkActive})},checkActive:function(){if(d.get("gw_activated")){if(typeof this.activeCallBack==="function"){this.activeCallBack()}return}this.$activeTmpl=this.$activeTmpl||$("#tmpl-userActiveDailog");$.fancybox.show(this.$activeTmpl.tmpl(),this.bindActiveForm)},bindLoginForm:function(){var j=$("div.login-container input.input-s[name=username]");var i=$("div.login-container input.input-s[name=password]");var k=new h({obj:j,password:i,appendTo:"div.login-container"});j.bind("keydown",function(m){if(m.keyCode===13){i.focus();m.preventDefault()}});var l=d.get("P_INFO");if(typeof l==="string"&&l.split("|")[0].indexOf("@")>0){j.val(l.split("|")[0]).removeClass("color-gray")}},bindActiveForm:function(){$(".activate-container form").bind("submit",this.onActiveSubmit)},onActiveSubmit:function(i){var j=$(".activate-container .login-btn span");if(j.attr("class")!=="btni04"){return}var k={subEdm:0};if($("#userActivateDailog1").attr("checked")){k.subEdm=1}$.ajax({cache:false,data:k,dataType:"json",timeout:30000,type:"post",url:a.active,success:this.onActiveSucc,error:this.showActiveError});i.preventDefault()},onActiveSucc:function(i){if(i.status==="succ"){if(typeof this.activeCallBack==="function"){this.activeCallBack()}else{$.fancybox.close()}}else{this.showActiveError()}},showActiveError:function(){var i="真抱歉！系统出错啦，请稍后到惠惠首页激活吧~您可以先逛逛超值购或全攻略，但购物前记得一定要先激活才能拿返现哦~";App.showError(i)}};f.init();return f});define("common/selection",function(e,b,a){function d(f,h,j){if(!f){return}h=h<0?0:h;j=j<h?h:j;function g(){if(h!==j){return}var k=!!(window.attachEvent&&navigator.userAgent.indexOf("Opera")===-1);if(!k){return}window.setTimeout(function(){f.blur();window.setTimeout(function(){f.focus()},0)},0)}if(f.setSelectionRange){f.focus();f.setSelectionRange(h,j);g();return}if(f.createTextRange){var i=f.createTextRange();i.collapse(true);i.moveStart("character",h);i.moveEnd("character",j-h);i.select();g()}}var c=e("common/app.ctrl");c.extend({Selection:{setSelectionRange:d}})});define("common/app_loading",function(d,b,a){var e=$('<div style="position:absolute;top:0;width:100%;background-color:#FFF;z-index:auto;">');var c=false;var g=false;var f={};e.css("opacity",0.5);f.loading={shade:function(i){var h;if(c){return}c=true;if(!!!i){i=$("body")}h=i.height();e.css("height",h+"px");if(i.css("position")==="static"){i.css("position","relative");g=true}e.appendTo(i)},shadeMove:function(){if(g){e.parent().css("position","static");g=false}e.remove();c=false}};$.extend(App,f)});define("common/app.ctrl",function(e,c,b){window.App=window.App||{};var a=window.App;function f(){return a}function d(g){$.extend(a,g)}return{getInstance:f,extend:d}});define("common/fancybox.plus",function(g,c,b){var e={closeButton:".fancybox-close"};var a=[];var f=false;function d(j){var h=j.content;var i=j.completeCallback;$.fancybox({content:h,centerOnScroll:true,modal:true,overlayOpacity:0.6,overlayColor:"#000000",onComplete:function(){i()}})}$.fancybox.show=function(h,i){a.push({content:h,completeCallback:function(){if($.isFunction(i)){i()}if(a.length===0){f=false}else{d(a.shift())}}});if(f){return}f=true;d(a.shift())};$(document).delegate(e.closeButton,"click",function(h){$.fancybox.close();h.preventDefault()})});define("common/phone.auth",function(f,b,a){var e=false;var d={isAuth:function(h){var i=this;var g=f("common/config");if(e){return}e=true;$.ajax({cache:false,dataType:"json",timeout:30000,type:"GET",url:g.isPhoneAuth,success:function(j){e=false;if(j.status==="succ"){h();return}i.add(null,h)},error:function(j){e=false;App.showError()}})},add:function(g,h){var i=f("common/transceiver").create();i.trigger("mobile:validate:show",{type:0,phone:g,callback:h})},update:function(g){var h=f("common/transceiver").create();h.trigger("mobile:validate:show",{type:1,callback:g})}};var c=f("common/app.ctrl");c.extend({phoneAuth:d})});define("common/transceiver",function(f,b,a){var c=[];var g=0;function d(){this.id="t-"+(g++)}var e={listen:function(i,k,j){var m=this._callbacks||(this._callbacks={});var l=m[i]||(m[i]=[]);l.push([k,j]);return this},unlisten:function(j,k){var o;if(!j){this._callbacks={}}else{if(o=this._callbacks){if(!k){o[j]=[]}else{var n=o[j];if(!n){return this}for(var p=0,m=n.length;p<m;p++){if(n[p]&&k===n[p][0]){n[p]=null;break}}}}}return this},_trigger:function(q){var p,r,j,n,m;var k=2;if(!(r=this._callbacks)){return this}while(k--){j=k?q:"all";if(p=r[j]){for(var s=0,o=p.length;s<o;s++){if(!(n=p[s])){p.splice(s,1);s--;o--}else{m=k?Array.prototype.slice.call(arguments,1):arguments;n[0].apply(n[1]||this,m)}}}}return this},trigger:function(j){var i=[].slice.call(arguments);_.each(c,function(k){_.defer.apply(_,[_.bind(k._trigger,k)].concat(i))})}};_.extend(d.prototype,e);function h(){var i=new d();c.push(i);return i}return{create:h}});define("common/config",function(e,c,b){var a="";var d={active:"/activate/request.json",baseUrl:a,data:a+"back.php",errorImage:"http://placehold.it/670x450",errorMsg:"真抱歉！系统出错啦！请稍后访问！",exchangeCash163:"/account/epay/transfer.json",exchangeCashAlipay:"/account/alipay/transfer.json",exchangeGoods:function(f,g){return"/coupons/"+f+"/exchange.json"},exchangeRate:100,favor:function(f){return"/deals/"+f+"/fav.json"},getAlipayAccount:"/account/alipay/info.json",getCouponsSugget:"/suggest/coupons.json",getGoodsPics:function(f){return a+"back.php?call=getGoodsPics&id="+f},getGoodsPrices:function(f){return a+"back.php?call=getGoodsPrices&id="+f},getGoodsSugget:"http://gsuggest.ydstatic.com/suggest/suggest.s?o=_hui_goods&count=10&keyfrom=GouwuSuggest.suggest",getPageHtml:function(f){return a+"back.php?call=getPageHtml&pageNo="+f},getShop:a+"getShop.php",getShopComment:function(f,g){return"/mall/"+f+"/comments?1=1&page="+g},getShopSugget:"/suggest/shops.json",getUserPoint:"/account/summary/available.json",isPhoneAuth:"/account/info//auth_phone.json",isTest:"test",log:"/log?",noticeTime:30,notice:"/remind/unread.json",postShopComment:function(f){return"/mall/"+f+"/comments.json"},readAll:"/remind/read_all.json",register:"/register/regist",saveUnionLogin:"/account/union",setAccount:"/account/info/identity.json",setAlipayAccount:"/account/alipay/info/modify.json",share:function(f){return"/deals/"+f+"/share.json"},userInfo:"/log",updateUserInfo:"/account/info/update.json",validateAccount:"/register2/check_username.json",check:a+"/log",getDomain:function(){var f=window.location.host.split(":")[0];return"."+f}};return d});define("common/key.scorll",function(c,b,a){var d={init:function(){this.handle=false;this.isTrigger=true;this.originGoValue=400;this.goValue=400;this.delay=500;this.$elem=$("html, body");this.addEvent()},addEvent:function(){this.keydownProcess=this.keydownProcess.bind(this);this.scorll=this.scorll.bind(this);$(document).bind("keydown",this.keydownProcess);$(document).delegate("input, textarea","focus",(function(){this.isTrigger=false}).bind(this));$(document).delegate("input, textarea","blur",(function(){this.isTrigger=true}).bind(this))},keydownProcess:function(f){if(this.handle){this.goValue+=200;return}this.handle=true;window.setTimeout((function(){this.scorll(f);this.handle=false}).bind(this),50)},scorll:function(g){if(!(g.keyCode===74||g.keyCode===75)){return}if(!this.isTrigger){return}var j=$(document).scrollTop();var f=$(document).height();var k=$(window).height();var h=0;var i=function(){this.goValue=this.originGoValue};i=i.bind(this);if(g.keyCode===74){h=j+this.goValue;if(j+k===f){i();return}}if(g.keyCode===75){h=j-this.goValue;if(j===0){i();return}}this.$elem.stop();this.$elem.animate({scrollTop:h},this.delay,i)}};return d});define("common/cookie",function(e,b,a){var d=function(k,f,h){var j;var g=k+"="+escape(f)+";path=/";var i=window.location.host.split(":")[0];i="."+i;g+=";domain="+i;if(!!parseInt(h)){j=new Date();j.setDate(j.getDate()+h);g+=";expires="+j.toGMTString()}document.cookie=g};var c={add:function(h,f,g){if(this.get(h)){throw"this cookie is already exsit!"}d(h,f,g)},clear:function(){var f=this.getAll();for(var g in f){if(g!==""){this.del(g)}}},del:function(f){if(!this.get(f)){throw"this cookie is undefined!"}d(f,0,-1)},update:function(h,f,g){if(!this.get(h)){throw"this cookie is undefined!"}d(h,f,g)},get:function(f){return this.getAll()[f]},getAll:function(){var g=document.cookie.split(";");var h={};var f;var k;for(var l=0,j=g.length;l<j;l++){f=g[l].split("=");k=f[0].replace(/^\s*|\s*$/g,"");if(f[1]){h[k]=f[1]}}return h}};return c});define("common/tab_menu",function(e,b,a){var d={wrap:".tab-wrap",navs:".tab-nav a",contents:".tab-content-wrap .tab-content",navCurStyle:"current",contentCurStyle:"current",eventName:"click",start:null,callback:null};function c(f){this.init(f)}c.prototype={init:function(g){this.params=$.extend({},d,g);this.$wrap=$(this.params.wrap);this.$navs=this.$wrap.find(this.params.navs);this.$contents=this.$wrap.find(this.params.contents);var f=this;this.$navs.live(this.params.eventName,function(i){i.preventDefault();var j=$(this);var h=f.$navs.index(j);f.currentIndex=h;if($.isFunction(f.params.start)){f.params.start(function(){f.swap(h)})}else{f.swap(h)}})},swap:function(g){if(g<0||g>this.$navs.length-1){return}var h=this.$navs.eq(g);var f=this.$contents.eq(g);if(h.hasClass(this.params.navCurStyle)){return}this.$navs.removeClass(this.params.navCurStyle);h.addClass(this.params.navCurStyle);if(f.length==0){return}this.$contents.removeClass(this.params.contentCurStyle);f.addClass(this.params.contentCurStyle);if($.isFunction(this.params.callback)){this.params.callback()}},swapTab:function(h){var g=this.$navs.filter("[data-tabname="+h+"]");var f=this.$navs.index(g);this.swap(f)},getIndex:function(){return this.$navs.index(this.$navs.filter("."+this.params.navCurStyle))},currentIndex:0};return c});define("modules/template/verifyphone_dailog/phone.code",function(m,b,c){var l={code:"input[data-action=code]",codeButton:"a[data-action=code-button]"};var k=0;var f;var d;var j;var e;var n;var g;function o(){if(k>0){g.html("（"+k+"）秒后重新获取").addClass("disabled")}else{g.html("免费获取验证码").removeClass("disabled");window.clearInterval(f)}}function h(p){var r="div.dtips[data-ikey=invalid-"+p+"]";var s=e.find(r);if(s.length>0){s.show();return}App.showError(p)}function i(){if(k>0){return}if(!d){return}f=window.setInterval(function(){k--;o()},1000);k=59;o();$.ajax({cache:false,dataType:"json",timeout:30000,type:"POST",data:{phone:d},url:j,success:function(p){if(p.status==="fail"){h(p.message);if(p.message==="duplicated_phone"){k=0;o()}return}},error:function(p){k=0;o()}})}function a(r,p,q){e=q;n=e.find(l.code);g=e.find(l.codeButton);d=p;j=g.data("url");if(r===0&&k===0){i()}else{o()}g.bind("click",function(){i()})}return{init:a,setPhone:function(p){d=p}}});define("modules/template/verifyphone_dailog/phone.bind",function(k,a,b){var i={submit:"span[data-action=submit]"};var j=[];var l;var f;var h;var g;var c;function e(){if(!h){h=c.find(i.submit).data("url")}if(g){return}g=true;var p=k("common/form_helper");var n=p.getFeildsByName(c);var o=p.getDataMap(n);$.ajax({cache:false,dataType:"json",timeout:30000,type:"POST",url:h,data:o,success:function(s){g=false;if(s.status==="succ"){if($.isFunction(f)){f.call({},$.trim(n.phone.val()))}else{$.fancybox.close()}return}var r=["div.dtips[data-ikey=invalid-","","]"];if(s.message==="phoneCodeError"){r[1]="phoneCodeError";c.find(r.join("")).show();return}if(s.message==="phoneError"){r[1]="phoneError";c.find(r.join("")).show();return}if(s.message==="invalidPhone"){r[1]="invalid_phone";c.find(r.join("")).show();return}if(s.message==="duplicatedPhone"){r[1]="duplicated_phone";c.find(r.join("")).show();return}if(s.message==="exceed_ip"){r[1]="exceed_ip";c.find(r.join("")).show();return}if(s.message==="exceed_phone"){r[1]="exceed_phone";c.find(r.join("")).show();return}if(s.message==="exceed_email"){r[1]="exceed_email";c.find(r.join("")).show();return}if(s.message==="exceed_frequency"){r[1]="exceed_frequency";c.find(r.join("")).show();return}if(s.message==="bad_request"){r[1]="bad_request";c.find(r.join("")).show();return}if(s.message==="sysError"||s.message==="sys_error"){r[1]="sys_error";c.find(r.join("")).show();return}App.showError(s.message)},error:function(q){g=false;App.showError()}})}function m(){l.$elem.bind("blur",function(){l.validate();if(!l.isPass){return}var n=k("modules/template/verifyphone_dailog/phone.code");var o=n;o.setPhone($.trim(l.$elem.val()))});c.delegate(i.submit,"click",function(){var n;for(n=0;n<j.length;n++){j[n].validate();if(!j[n].isPass){return}}e()})}function d(q,o){c=q;f=o;var p=k("common/validate_feild");var n=c.find("input");var r;j=[];for(r=0;r<n.length;r++){j.push(new p(n.eq(r)));if(n.eq(r).attr("name")==="phone"){l=j[r]}}n.eq(0).trigger("focus");m()}return{init:d}});define("common/account_suggest",function(d,b,a){var f={e1:["163.com","126.com","yeah.net","vip.163.com","vip.126.com","popo.163.com","188.com","qq.com","yahoo.com","yahoo.com.cn","gmail.com","hotmail.com","sina.com","sina.cn","sohu.com","netease.com"],e2:["qq.com","gmail.com","hotmail.com","sina.cn","sohu.com"],e3:["163.com","126.com","yeah.net","vip.163.com","vip.126.com","popo.163.com","188.com","qq.com","yahoo.com","yahoo.com.cn","sina.com"]};var c={obj:null,password:null,elist:f.e3,appendTo:document.body};var e=function(h){var g=h.obj;var i=h.password;if(!!!g||g.length===0){throw"the params conf is error"}g.attr("autocomplete","off");g.parents("form").attr("autocomplete","off");if(!!!i||i.length===0){throw"the params conf is error"}this.conf=$.extend({},c,h);this.init()};e.prototype={init:function(){this._createSuggestList();this._positon();this._initEvent()},_createSuggestList:function(){this.suglst=$('<ul class="account_suggest_ctn"><li class="title">请选择或继续输入...</li></ul>');var h=[];for(var k=0,j=this.conf.elist.length;k<j;k++){h[h.length]="<li>@"+this.conf.elist[k]+"</li>"}this.suglst.append(h.join(""));var g=$(this.conf.appendTo);if(g[0]!==document.body&&g.css("position")==="static"){g.css("position","relative")}$(this.conf.appendTo).append(this.suglst)},_positon:function(){var i=this.conf.obj.offset();var j=$(this.conf.appendTo);var g=j.offset();var k=0;var h=0;if(j[0]!==document.body){k=parseInt(j.css("border-left-width"));h=parseInt(j.css("border-top-width"));k=isNaN(k)?0:k;h=isNaN(h)?0:h}this.suglst.css({left:i.left-g.left-k,top:i.top-g.top+parseInt(this.conf.obj.outerHeight())-1-h,width:(parseInt(this.conf.obj.outerWidth())-2)})},_initEvent:function(){var g=navigator.appVersion;var h=g.match(/Konqueror|Safari|KHTML/)?"keydown":"keypress";var i=this;i.conf.obj.bind(h,function(l){var k=$(this);var j=l.keyCode;if(j==13){l.stopPropagation();l.preventDefault();return true}else{return true}});this.conf.obj.keyup(this.bind(this,this._keyupHandler));this.conf.obj.blur(this.bind(this,this._blurHandler));this.suglst.find("li").mouseover(this.bind(this,this._mouseoverHandler));this.suglst.find("li").mouseout(this.bind(this,this._mouseoutHandler))},_setContent:function(h){var g=this.suglst.find("li"),m=this.conf.elist;for(var k=0,j=m.length;k<j;k++){g[k+1].innerHTML=h+"@"+m[k]}},_keyupHandler:function(m){m.stopPropagation();m.preventDefault();var g,h,k=null,j=0,n=m.which;if(n===40){return this._downKeyHandler()}else{if(n===38){return this._upKeyHandler()}else{if(n===13){return this._enterKeyHandler()}else{g=this.conf.obj.val();g=$.trim(g);if(g.length==0){this.suglst.css("display","none");return}h=g.split("@");if(h.length===1){this._setContent(h[0]);this.suglst.find("li").show();this.suglst.css("display","block")}else{k=new RegExp("^"+h[1],"i");for(var p=0,o=this.conf.elist.length;p<o;p++){if(!k.test(this.conf.elist[p])){this.suglst.find("li").eq(p+1).hide().removeClass("on");j+=1}else{this.suglst.find("li").eq(p+1).show()}}if(j<this.conf.elist.length){this._setContent(h[0]);this.suglst.css("display","block")}else{this.suglst.hide();return false}}}}}},_blurHandler:function(j){j.stopPropagation();var h=this.suglst.find("li.on");var g=$.trim(this.conf.obj.val());var i=this.conf.obj.attr("def-data");if(g===""||g===i){this.conf.password.focus();return}if(this.suglst.css("display")==="none"){this.conf.password.focus();return}if(h.length!==0){this.conf.obj.val(h.html()).change();this.conf.password.focus()}else{h=this.suglst.find("li:visible");if(h.length<2){return}h=h.eq(1);this.conf.obj.val(h.html()).change();this.conf.password.focus()}this.suglst.hide()},_downKeyHandler:function(){if(this.suglst.css("display")==="none"){return false}var g=this.suglst.find("li.on"),h;if(g.length===0){g=this.suglst.find("li:visible").eq(1);g.addClass("on")}else{h=g.next("li");while(h.length!==0){if(h.css("display")==="none"){h=h.next("li")}else{break}}if(h.length===0){h=this.suglst.find("li:visible").eq(1)}g.removeClass("on");h.addClass("on")}return false},_upKeyHandler:function(){if(this.suglst.css("display")==="none"){return false}var h=this.suglst.find("li.on"),g;if(h.length===0){h=this.suglst.find("li:visible").last();h.addClass("on")}else{g=h.prev("li");while(!g.hasClass("title")){if(g.css("display")==="none"){g=g.prev("li")}else{break}}if(g.hasClass("title")){g=this.suglst.find("li:visible").last()}h.removeClass("on");g.addClass("on")}return false},_enterKeyHandler:function(){var g=this.suglst.find("li.on");if(g.length===0){return}this.conf.obj.val(g.html());this.suglst.hide().find("li.on").removeClass("on");this.conf.password.focus()},_mouseoutHandler:function(h){var g=$(h.target);if(g.hasClass("title")){return false}g.removeClass("on");return false},_mouseoverHandler:function(h){var g=$(h.target);if(g.hasClass("title")){return false}this.suglst.find("li.on").removeClass("on");g.addClass("on");return false},bind:function(h,g){return function(){g.apply(h,arguments)}}};return e});define("common/validate_feild",function(e,c,b){var a={show:function(h,f){var g=h.find(".prompt-state");g.filter("[data-ikey="+f+"]").show()},hide:function(h,f){var g=h.find(".prompt-state");g.filter("[data-ikey="+f+"]").hide()},hideAll:function(f){f.find(".prompt-state").hide()},exeRule:function(h,f){d.rules[h].lastIndex=0;var g=d.rules[h];if($.isFunction(g)){return g(f)}else{return g.exec(f)}}};var d=function(g,f){this.$elem=g;if(!f){this.$promptWrap=g.parent()}else{this.$promptWrap=f}this.isPass=false;var h=g.data("rules");this.rules=h?h.split(","):[];this.relation=g.data("relation");this.required=g.data("required");this.config()};d.prototype={config:function(){var g=this;var f=g.$elem;f.bind("blur",function(){g.validate()});f.bind("focus",function(){a.hideAll(g.$promptWrap)})},hideAll:function(){a.hideAll(this.$promptWrap)},validate:function(){var f=this.check();if(!f.isPass){a.show(this.$promptWrap,f.ikey)}},check:function(){var k=this;var j=k.$elem;var g=$.trim(j.val());var f="";var l=k.required===1;var h=j.attr("def-data");if(l){if(g===""||g===h){k.isPass=false}f="invalid-empty"}else{k.isPass=true}if(g!==""&&g!==h){if(k.relation&&k.relation==="or"){k.isPass=false;for(var i in k.rules){if(a.exeRule(k.rules[i],g)){k.isPass=true;break}}f="invalid-"+k.rules[0]}else{k.isPass=true;for(var i in k.rules){if(!a.exeRule(k.rules[i],g)){k.isPass=false;f="invalid-"+k.rules[i];break}}}}return{isPass:k.isPass,ikey:f}}};d.rules={cnChars:/^[\u4e00-\u9fa5]+$/g,encnChars:/^[\u4e00-\u9fa5A-Za-z0-9_]+$/g,decimal2:/^\d+(\.\d{1,2})?$/,email:/^([a-z0-9_][a-z0-9_.-]*)?[a-z0-9_-]@([a-z0-9-]+\.){0,4}([a-z0-9][a-z0-9-]{0,61})?[a-z0-9]\.[a-z]{2,6}$/i,ID:/^\d{15}|\d{18}$/g,IDs:function(f){var g=e("common/validate_identity");return g(f)},min6:function(f){return f.length>=6},phone:/^1\d{10}$/g,postCode:/^[0-9]\d{5}(?!\d)$/g,qq:/^[1-9][0-9]{4,}$/g,telphone:/^(\d{3}-)?\d{7,8}(-\d{1,6})?$|^(\d{4}-)?\d{7,8}(-\d{1,6})?$/g};return d});define("common/form_helper",function(d,b,a){var e="ignore-feild";var c={getFeildsByName:function(j){var f=j.find("input[class!="+e+"], textarea[class!="+e+"]");var h={};var g;for(var l=0,k=f.length;l<k;l++){g=$.trim(f.eq(l).attr("name"));if(g!==""&&!h[g]){h[g]=j.find("input[class!="+e+"][name="+g+"], textarea[class!="+e+"][name="+g+"]")}}return h},getDataMap:function(h){var k=h;var l="";var n="";for(var j in k){l+=j;l+="=";if(k[j].length===1){n=k[j].attr("type");switch(n){case"radio":throw"Exception: Only one radio button!";break;case"checkbox":l+=k[j].attr("checked")?true:false;break;default:var g=k[j].attr("def-data");var f=$.trim(k[j].val());if(g!=="undefined"&&f===g){f=""}l+=encodeURIComponent(f);break}}else{n=k[j].eq(0).attr("type");switch(n){case"radio":l+=$.trim(encodeURIComponent(k[j].filter("[checked]").val()));break;case"checkbox":for(var o=0,m=k[j].length;o<m;o++){if(!k[j].eq(o).attr("checked")){continue}l+=$.trim(encodeURIComponent(k[j].eq(o).val()));l+=","}if(l[l.length-1]===","){l=l.substring(0,l.length-1)}break;default:for(var o=0,m=k[j].length;o<m;o++){l+=$.trim(encodeURIComponent(k[j].eq(o).val()));if(o<m-1){l+=","}}break}}l+="&"}if(l!==""){l=l.substring(0,l.length-1)}return l}};return c});define("common/validate_identity",function(m,a,b){var j=/^[1-9]((\d{14})|(\d{16}(\d|x)))$/gi,n=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],c=["1","0","x","9","8","7","6","5","4","3","2"],l=[],f=new Date().getTime(),i=f-100*365*24*60*60*1000;var d=function(){var o=0;for(var q=0,p=n.length;q<p;q++){o+=n[q]*l[q]}return c[o%11]},e=function(o){return o.match(/\d|x/gi)},k=function(r,q){var o=function(s){return((s%4==0&&s%100!=0)||(s%400==0))?true:false},p=[31,28,31,30,31,30,31,31,30,31,30,31];if(q==2&&o(r)){return 29}return p[q-1]},h=function(){var q,p,o,r=new Date();if(l.length===18){q=l.slice(6,10).join("")-0;p=l.slice(10,12).join("")-0;o=l.slice(12,14).join("")-0}else{q="19"+l.slice(6,8).join("")-0;p=l.slice(8,10).join("")-0;o=l.slice(10,12).join("")-0}if(q===0||p===0||o===0||q>r.getFullYear()||p>12){return false}if(o>k(q,p)){return false}r.setFullYear(q);r.setMonth(p-1);r.setDate(o);if(r.getTime()>=f||r.getTime()<i){return false}return true};function g(o){o=o.toLowerCase();j.lastIndex=0;if(!j.test(o)){return false}l=e(o);if(l.length===18){if(l[l.length-1]!==d()){return false}}if(!h()){return false}return true}return g});define("page/p-shop",function(c,b,a){c("common/es5");c("common/lib_plus");c("modules/global/top/notice_remind");c("modules/global/top/order_remind");c("modules/global/top/top");c("modules/global/search_box/suggest");c("modules/global/search_box/tips");c("modules/global/nav/nav");c("modules/global/nav/shops_tip");c("modules/global/nav/favorite");c("modules/discount/shop_archives/shop_archives");c("modules/discount/shop_archives/tips");c("modules/discount/shop_introduce/comment_score");c("modules/discount/shop_introduce/pager");c("modules/discount/shop_introduce/shop_introduce");c("modules/discount/shop_introduce/tab_menu");c("modules/coupons/hot_coupons/hot_coupons");c("modules/discount/shop_comment/shop_comment");c("modules/global/new_feedback/new_feedback");c("modules/huihui/login_guide/login_guide");c("modules/template/cshop_skip_dailog/cshop_skip_dailog");c("modules/template/verifyphone_dailog/verifyphone");c("fragments/login/login");c("modules/template/oauth_cancel_dailog/oauth_cancel_dailog")});